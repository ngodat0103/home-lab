# teleport-install.yml
- name: Install/upgrade Teleport via official script
  hosts: teleport
  gather_facts: false
  vars:
    teleport_version: "18.1.8"
    teleport_edition: "oss" # oss | enterprise | enterprise-fips
    install_script_url: "https://cdn.teleport.dev/install.sh"
    install_script_path: "/usr/local/src/teleport-install.sh"
  tasks:
  - name: Download Teleport install script
    get_url:
      url: "{{ install_script_url }}"
      dest: "{{ install_script_path }}"
      mode: "0755"
      force: yes
  - name: Run installer for desired version/edition
    command: "bash {{ install_script_path }} {{ teleport_version }} {{ teleport_edition }}"
  - name: Enable & start Teleport service
    systemd:
      name: teleport
      enabled: true
      state: started